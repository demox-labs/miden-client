<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WASM Example</title>
</head>
<body>
    <script type="module" src="./dist/index.js"></script>
    <script type="module">
        // Example of using the exported WebClient in the browser
        import { WebClient } from './dist/index.js';
        
        async function testCreateClient() {
            try {
                const webClient = new WebClient();
                await webClient.create_client();
                return webClient;
            } catch (error) {
                console.error('Failed to create client with web store:', error);
            }
        }

        async function testStoreAndRpc(webClient) {
            try {
                await webClient.test_store_and_rpc();
            } catch (error) {
                console.error('Failed to create client with web store:', error);
            }
        }

        async function testNewAccount(webClient) {
            const basicMutableTemplate = {
                type: "BasicMutable"
            };
            const fungibleFaucetTemplate = {
                type: "FungibleFaucet",
                decimals: 18,
                max_supply: 1000000
            };
            try {
                await webClient.new_account(basicMutableTemplate);
                await webClient.new_account(fungibleFaucetTemplate);
            } catch (error) {
                console.error('Failed to call create account:', error);
            }
        }

        async function testGetAccounts(webClient) {
            try {
                await webClient.get_accounts();

            } catch (error) {
                console.error('Failed to call get accounts:', error);
            
            }
        }

        async function testGetAccount(webClient) {
            try {
                await webClient.get_account("0xTestAccounStringHex");

            } catch (error) {
                console.error('Failed to call get account:', error);
            
            }
        }

        async function testGetAccountStubById(webClient) {
            try {
                await webClient.get_account_stub_by_id("0xTestAccounStringHex");

            } catch (error) {
                console.error('Failed to call get account stub by id:', error);
            
            }
        }

        async function testGetAccountAuth(webClient) {
            try {
                await webClient.get_account_auth("0xTestAccounStringHex");

            } catch (error) {
                console.error('Failed to call get account auth:', error);
            
            }
        }

        let webClient = await testCreateClient();
        await testStoreAndRpc(webClient);
        await testNewAccount(webClient);
        await testGetAccounts(webClient);
        await testGetAccount(webClient);
        await testGetAccountStubById(webClient);
        await testGetAccountAuth(webClient);
    </script>
</body>
</html>